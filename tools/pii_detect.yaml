identity:
  name: pii_detect
  author: AI Assistant
  label:
    en_US: PII Detection
    zh_Hans: PII 检测
description:
  human:
    en_US: Detect Personally Identifiable Information (PII) in text using AI analysis
    zh_Hans: 使用AI分析检测文本中的个人身份识别信息（PII）
  llm: This tool analyzes text to detect and identify Personally Identifiable Information (PII) such as names, emails, phone numbers, addresses, ID numbers, and other sensitive personal data. It uses AI-powered analysis to provide accurate detection with confidence scores and risk assessment.
parameters:
  - name: text
    type: string
    required: true
    label:
      en_US: Text to analyze
      zh_Hans: 待分析的文本
    human_description:
      en_US: The text content to be analyzed for PII detection
      zh_Hans: 需要进行PII检测的文本内容
    llm_description: The input text that needs to be analyzed for detecting personally identifiable information. This can be any text content including documents, messages, forms, etc.
    form: llm
  - name: pii_categories
    type: string
    required: false
    label:
      en_US: PII Categories (optional)
      zh_Hans: PII类别（可选）
    human_description:
      en_US: Comma-separated list of PII categories to detect (e.g., "person_name,email,phone"). Leave empty to detect all categories.
      zh_Hans: 要检测的PII类别，用逗号分隔（如"person_name,email,phone"）。留空则检测所有类别。
    llm_description: Optional comma-separated list of specific PII categories to focus on. Available categories include person_name, email, phone, id_number, address, bank_account, credit_card, passport, driver_license, social_security, date_of_birth, organization. If not specified, all categories will be checked.
    form: llm
  - name: model
    type: model-selector
    scope: llm
    required: true
    label:
      en_US: LLM Model
      zh_Hans: 使用的LLM模型
    human_description:
      en_US: Select the LLM model to use for PII detection
      zh_Hans: 选择用于PII检测的LLM模型
    llm_description: The LLM model to use for analyzing and detecting PII information in the text
    form: form
extra:
  python:
    source: tools/pii_detect.py
output_schema:
  type: object
  properties:
    detection_result:
      type: object
      description: Complete PII detection result including detected items, risk level, and summary
    has_pii:
      type: boolean
      description: Whether any PII was detected in the text
    risk_level:
      type: string
      description: Overall risk level assessment (low/medium/high)